# AI-Readiness Action

A comprehensive GitHub Action that analyzes repositories for AI-readiness by checking code quality tools, documentation, test coverage, and architecture testing practices.

## Features

- ✅ **Multi-Language Support**: JavaScript, TypeScript, and Java (extensible to Kotlin, Rust)
- ✅ **Documentation Checks**: Verifies presence of `AGENTS.md` and `SKILLS.md` files
- ✅ **Code Formatters**: Prettier (JS/TS), Checkstyle, Spotless (Java)
- ✅ **Type Checking**: TypeScript configuration, Java built-in types
- ✅ **Linting**: ESLint (JS/TS), SpotBugs, PMD (Java)
- ✅ **SAST**: CodeQL, Semgrep detection
- ✅ **Architecture Tests**: eslint-plugin-boundaries (JS/TS), ArchUnit (Java)
- ✅ **Test Coverage**: Jest, Vitest (JS/TS), JaCoCo (Java) with configurable thresholds
- ✅ **Data Collection Only**: No scoring, pure information gathering for external processing
- ✅ **Non-Breaking**: Always succeeds, never fails your CI/CD pipeline

## Quick Start

### 1. Add to Your Repository

Create `.github/workflows/ai-readiness.yml` in your repository:

```yaml
name: AI Readiness Check

on:
  push:
    branches: [main, develop]
  pull_request:

jobs:
  ai-readiness:
    uses: your-org/ai-readiness-action/.github/workflows/ai-readiness.yml@v1
    with:
      endpoint_url: ${{ vars.AI_READINESS_ENDPOINT }}
      coverage_threshold: 90
    secrets:
      endpoint_token: ${{ secrets.AI_READINESS_TOKEN }}
```

### 2. Configure Variables and Secrets

In your repository or organization settings:

- **Variable**: `AI_READINESS_ENDPOINT` - Your HTTP endpoint URL
- **Secret**: `AI_READINESS_TOKEN` - (Optional) Bearer token for authentication

### 3. Ensure Coverage Files Exist

The action assumes coverage files are already generated by previous CI steps:

```yaml
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - run: npm ci
      - run: npm test -- --coverage  # Generates coverage files
      
  ai-readiness:
    needs: test  # Runs after test job
    uses: your-org/ai-readiness-action/.github/workflows/ai-readiness.yml@v1
    # ... rest of configuration
```

## Inputs

| Input | Required | Default | Description |
|-------|----------|---------|-------------|
| `endpoint_url` | Yes | - | HTTP endpoint to POST JSON results |
| `coverage_threshold` | No | 90 | Minimum coverage percentage (0-100) |

## Secrets

| Secret | Required | Description |
|--------|----------|-------------|
| `endpoint_token` | No | Authorization bearer token for the endpoint |

## Supported Languages and Tools

### JavaScript / TypeScript

| Category | Tools Detected |
|----------|----------------|
| Formatters | Prettier |
| Type Checking | TypeScript (tsconfig.json) |
| Linting | ESLint |
| SAST | CodeQL, Semgrep |
| Architecture | eslint-plugin-boundaries |
| Coverage | Jest, Vitest |

### Java

| Category | Tools Detected |
|----------|----------------|
| Formatters | Checkstyle, Spotless, Google Java Format |
| Type Checking | Built-in (always true) |
| Linting | SpotBugs, PMD |
| SAST | CodeQL, Semgrep |
| Architecture | ArchUnit |
| Coverage | JaCoCo |
| Build Tools | Maven, Gradle (Groovy & Kotlin DSL) |

## JSON Output Schema

The action posts a comprehensive JSON report to your endpoint:

```json
{
  "metadata": {
    "repository": {
      "name": "owner/repo-name",
      "url": "https://github.com/owner/repo-name",
      "commit_sha": "abc123...",
      "branch": "main",
      "run_id": "1234567890",
      "run_url": "https://github.com/owner/repo/actions/runs/1234567890"
    },
    "timestamp": "2026-01-31T12:00:00Z",
    "workflow_version": "1.0.0"
  },
  "languages": {
    "detected": ["javascript", "typescript"],
    "primary": "typescript"
  },
  "checks": {
    "documentation": {
      "agents_md": {
        "present": true,
        "path": "AGENTS.md"
      },
      "skills_md": {
        "count": 2,
        "paths": ["SKILLS.md", "docs/ai/SKILLS.md"]
      }
    },
    "formatters": {
      "javascript": {
        "prettier": {
          "present": true,
          "config_file": ".prettierrc.json"
        }
      },
      "java": {
        "checkstyle": { "present": false },
        "spotless": { "present": false },
        "google_java_format": { "present": false }
      }
    },
    "type_checking": {
      "typescript": {
        "present": true,
        "config_file": "tsconfig.json"
      },
      "java": {
        "present": false
      }
    },
    "linting": {
      "javascript": {
        "eslint": {
          "present": true,
          "config_file": "eslint.config.js"
        }
      },
      "java": {
        "spotbugs": { "present": false },
        "pmd": { "present": false }
      }
    },
    "sast": {
      "codeql": {
        "present": true,
        "workflow_file": ".github/workflows/codeql.yml"
      },
      "semgrep": {
        "present": false
      }
    },
    "architecture_tests": {
      "javascript": {
        "eslint_boundaries": {
          "present": true,
          "package": "eslint-plugin-boundaries",
          "version": "^4.2.0"
        }
      },
      "java": {
        "archunit": {
          "present": false
        }
      }
    },
    "test_coverage": {
      "available": true,
      "tools_found": ["vitest"],
      "coverage": {
        "lines": {
          "total": 1250,
          "covered": 1156,
          "percentage": 92.48
        },
        "branches": {
          "total": 320,
          "covered": 285,
          "percentage": 89.06
        },
        "functions": {
          "total": 180,
          "covered": 172,
          "percentage": 95.56
        },
        "statements": {
          "total": 1280,
          "covered": 1184,
          "percentage": 92.50
        }
      },
      "meets_threshold": true,
      "threshold": 90,
      "coverage_file": "coverage/coverage-summary.json"
    }
  }
}
```

## Coverage File Locations

The action looks for coverage files in these locations:

### JavaScript/TypeScript
- `coverage/coverage-summary.json` (Jest)
- `coverage/vitest/coverage-summary.json` (Vitest)

### Java
- `target/site/jacoco/jacoco.xml` (JaCoCo)

## How It Works

1. **Language Detection**: Automatically detects project languages based on configuration files
2. **Parallel Checks**: Runs all checks concurrently for performance
3. **Data Collection**: Gathers information without scoring or interpretation
4. **HTTP POST**: Sends JSON report to your configured endpoint
5. **Non-Failing**: Always exits successfully, even on errors (errors are logged)

## Development

### Running Tests

```bash
npm test
```

### Running Locally

```bash
export ENDPOINT_URL="https://your-api.com/ai-readiness"
export ENDPOINT_TOKEN="your-token"
export COVERAGE_THRESHOLD="90"
export GITHUB_REPOSITORY="owner/repo"
export GITHUB_SHA="abc123"
export GITHUB_REF="refs/heads/main"

node scripts/index.js
```

## Extending to New Languages

To add support for Kotlin, Rust, or other languages:

1. Update `scripts/utils/language-detector.js` with detection logic
2. Add language-specific parsers in `scripts/utils/`
3. Update checker modules to handle new languages
4. Add tests for new functionality
5. Update this README

## Troubleshooting

### No endpoint configured
If `endpoint_url` is not provided, the action will log the JSON report to console instead of posting it.

### Coverage files not found
Ensure your test job runs before the ai-readiness job and generates coverage files in the expected locations.

### HTTP POST fails
The action will log the error and the complete JSON report to the console. The workflow will still succeed.

## Contributing

Contributions are welcome! Please:

1. Write tests for new features
2. Follow the existing code style
3. Update documentation
4. Ensure all tests pass

## License

MIT License - see [LICENSE](LICENSE) file for details.

## Support

For issues, questions, or contributions, please open an issue in the GitHub repository.
